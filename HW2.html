<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.8.25">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Leela Dixit">
<meta name="dcterms.date" content="2026-01-26">

<title>FEMA National Risk Index Scores by State</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="HW2_files/libs/clipboard/clipboard.min.js"></script>
<script src="HW2_files/libs/quarto-html/quarto.js" type="module"></script>
<script src="HW2_files/libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="HW2_files/libs/quarto-html/axe/axe-check.js" type="module"></script>
<script src="HW2_files/libs/quarto-html/popper.min.js"></script>
<script src="HW2_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="HW2_files/libs/quarto-html/anchor.min.js"></script>
<link href="HW2_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="HW2_files/libs/quarto-html/quarto-syntax-highlighting-7b89279ff1a6dce999919e0e67d4d9ec.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="HW2_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="HW2_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="HW2_files/libs/bootstrap/bootstrap-9e3ffae467580fdb927a41352e75a2e0.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<link href="HW2_files/libs/htmltools-fill-0.5.8.1/fill.css" rel="stylesheet">

<script src="HW2_files/libs/htmlwidgets-1.6.4/htmlwidgets.js"></script>

<script src="HW2_files/libs/d3-3.5.6/./d3.min.js"></script>

<link href="HW2_files/libs/circlepackeR-0.1/./style.css" rel="stylesheet">

<script src="HW2_files/libs/circlepackeR-binding-0.0.0.9000/circlepackeR.js"></script>



</head>

<body class="fullcontent quarto-light">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">FEMA National Risk Index Scores by State</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Leela Dixit </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">January 26, 2026</p>
    </div>
  </div>
  
    
  </div>
  


</header>


<p>In this project, we will be working with data from the Federal Emergency Management Agency (FEMA) Resilience Analysis and Planning Tool (RAPT). This tool has more than 100 layers of social data like population, infrastructure and hazards.</p>
<p>We will be working with the National Risk Index (NRI) which provides information about which communities are at risk to 18 different natural hazards. Each community is assigned a risk rating based on annual expected loss, social vulnerability, and community resilience. These risk ratings are represented by percentile ranking among all communities at the same risk level. We will use NRI data to answer the following question:</p>
<p>“How do FEMA National Risk Index scores for counties in California compare to those in other states?”</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># load packages</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(janitor)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(here)</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(treemapify)</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggraph)</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(igraph)</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(viridis)</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(treemap)</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggraph)</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(data.tree)</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(circlepackeR)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<section id="step-1-read-in-data" class="level3">
<h3 class="anchored" data-anchor-id="step-1-read-in-data">Step 1: Read in data</h3>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>nri <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="fu">here</span>(<span class="st">"data"</span>, <span class="st">"National_Risk_Index_Counties.csv"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">clean_names</span>()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</section>
<section id="step-2-plan-visualization" class="level3">
<h3 class="anchored" data-anchor-id="step-2-plan-visualization">Step 2: Plan Visualization</h3>
<p>Before we begin, we can make a tentative plan about how we will build our visualization to answer our question.</p>
<p><strong>Variables of interest</strong></p>
<ul>
<li><p>Inputs: Counties in California vs counties in the other continental US states</p>
<ul>
<li>Data type: Categorical</li>
</ul></li>
<li><p>Outputs: Risk index scores</p>
<ul>
<li>Data type: Categorical</li>
</ul></li>
</ul>
<p><strong>Types of plots</strong></p>
<p>Because we have a categorical input and categorical output, we have a few options for visualizations that would be appropriate.</p>
<p>Some options include:</p>
<ol type="1">
<li><p>spider plot</p></li>
<li><p>heatmap</p></li>
<li><p>treemap</p></li>
<li><p>grouped scatter</p></li>
<li><p>lollipop</p></li>
<li><p>barplot</p></li>
<li><p>sunburst</p></li>
<li><p>circular packing</p></li>
</ol>
<p>We will try a few of these options to see what best represents our question and our data.</p>
</section>
<section id="step-3-clean-and-explore-data" class="level3">
<h3 class="anchored" data-anchor-id="step-3-clean-and-explore-data">Step 3: Clean and explore data</h3>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co"># check overview of data</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(nri)</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="co"># quite a few columns (&gt;450) we do not want to look at</span></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a><span class="co"># most columns are dbl or chr</span></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a><span class="co"># over 3000 rows, so we will definitely need to summarise</span></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a><span class="co"># check how many scores and their names</span></span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a><span class="fu">unique</span>(nri<span class="sc">$</span>national_risk_index_rating_composite) <span class="co"># 5 scores, remove 'insufficient data'</span></span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a><span class="co"># count counties in each state for each score, left with 5 rows for each state </span></span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a>nri_scores <span class="ot">&lt;-</span> nri <span class="sc">%&gt;%</span> </span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">risk_score =</span> national_risk_index_rating_composite) <span class="sc">%&gt;%</span> </span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(risk_score <span class="sc">!=</span> <span class="st">"Insufficient Data"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">risk_score =</span> <span class="fu">fct_relevel</span>(risk_score, <span class="st">"Very Low"</span>, <span class="st">"Relatively Low"</span>, <span class="st">"Relatively Moderate"</span>, <span class="st">"Relatively High"</span>, <span class="st">"Very High"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(state_name, risk_score) <span class="sc">%&gt;%</span> </span>
<span id="cb3-16"><a href="#cb3-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">score_count =</span> <span class="fu">n</span>()) <span class="sc">%&gt;%</span> </span>
<span id="cb3-17"><a href="#cb3-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span>
<span id="cb3-18"><a href="#cb3-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-19"><a href="#cb3-19" aria-hidden="true" tabindex="-1"></a><span class="co"># quick plots to see what we are working with</span></span>
<span id="cb3-20"><a href="#cb3-20" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(nri_scores, <span class="fu">aes</span>(<span class="at">x =</span> state_name, <span class="at">y =</span> score_count)) <span class="sc">+</span></span>
<span id="cb3-21"><a href="#cb3-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">color =</span> risk_score))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(nri_scores, <span class="fu">aes</span>(<span class="at">x =</span> risk_score)) <span class="sc">+</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</section>
<section id="step-4-try-out-different-plots" class="level3">
<h3 class="anchored" data-anchor-id="step-4-try-out-different-plots">Step 4: Try out different plots</h3>
<p>Given that we have over 3000 counties and 192 total scores, 5 at most per state in the US, we can try a few plots that could be usable for that many variables before we move on to grouping more.</p>
<section id="heatmap" class="level4">
<h4 class="anchored" data-anchor-id="heatmap">1. Heatmap</h4>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(nri_scores, <span class="fu">aes</span>(<span class="at">x =</span> risk_score, <span class="at">y =</span> state_name, <span class="at">fill =</span> score_count)) <span class="sc">+</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_tile</span>()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="HW2_files/figure-html/unnamed-chunk-4-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="treemap" class="level4">
<h4 class="anchored" data-anchor-id="treemap">2. Treemap</h4>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co"># need to normalize counts as states have different amount of counties</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>nri_score_percent <span class="ot">&lt;-</span> nri_scores <span class="sc">%&gt;%</span> </span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(state_name) <span class="sc">%&gt;%</span> </span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">total =</span> <span class="fu">sum</span>(score_count)) <span class="sc">%&gt;%</span> </span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">percent =</span> <span class="fu">round</span>(score_count <span class="sc">/</span> total, <span class="dv">2</span>))</span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(nri_score_percent, <span class="fu">aes</span>(<span class="at">area =</span> percent, <span class="at">fill =</span> risk_score, <span class="at">label =</span> state_name, <span class="at">subgroup =</span> state_name)) <span class="sc">+</span></span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_treemap</span>() <span class="sc">+</span></span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_treemap_subgroup_border</span>() <span class="sc">+</span></span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_treemap_subgroup_text</span>()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="HW2_files/figure-html/unnamed-chunk-5-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="sunburst" class="level4">
<h4 class="anchored" data-anchor-id="sunburst">3. Sunburst</h4>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(nri_score_percent) <span class="sc">+</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="fu">aes</span>(<span class="at">x =</span> state_name, <span class="at">y =</span> percent, <span class="at">fill =</span> risk_score), <span class="at">stat =</span> <span class="st">"identity"</span>) <span class="sc">+</span></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_polar</span>()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="HW2_files/figure-html/unnamed-chunk-6-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="circular-packing" class="level4">
<h4 class="anchored" data-anchor-id="circular-packing">4. Circular Packing</h4>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>nri_scores<span class="sc">$</span>pathString <span class="ot">&lt;-</span> <span class="fu">paste</span>(<span class="st">"world"</span>, nri_scores<span class="sc">$</span>state_name, nri_scores<span class="sc">$</span>risk_score, nri_scores<span class="sc">$</span>score_count, <span class="at">sep =</span> <span class="st">'/'</span>)</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>population <span class="ot">&lt;-</span> <span class="fu">as.Node</span>(nri_scores)</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">circlepackeR</span>(population, <span class="at">size =</span> <span class="st">"score_count"</span>, <span class="at">color_min =</span> <span class="st">"hsl(56,80%,80%)"</span>, <span class="at">color_max =</span> <span class="st">"hsl(341,30%,40%)"</span>)</span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a>p</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div class="circlepackeR html-widget html-fill-item" id="htmlwidget-47f650ba5c45241f203f" style="width:100%;height:464px;"></div>
<script type="application/json" data-for="htmlwidget-47f650ba5c45241f203f">{"x":{"data":{"name":"world","children":[{"name":"Alabama","children":[{"name":"Very Low","children":[{"name":"17","risk_score":"Very Low","score_count":17,"state_name":"Alabama"}]},{"name":"Relatively Low","children":[{"name":"31","risk_score":"Relatively Low","score_count":31,"state_name":"Alabama"}]},{"name":"Relatively Moderate","children":[{"name":"15","risk_score":"Relatively Moderate","score_count":15,"state_name":"Alabama"}]},{"name":"Relatively High","children":[{"name":"4","risk_score":"Relatively High","score_count":4,"state_name":"Alabama"}]}]},{"name":"Alaska","children":[{"name":"Very Low","children":[{"name":"19","risk_score":"Very Low","score_count":19,"state_name":"Alaska"}]},{"name":"Relatively Low","children":[{"name":"7","risk_score":"Relatively Low","score_count":7,"state_name":"Alaska"}]},{"name":"Relatively Moderate","children":[{"name":"3","risk_score":"Relatively Moderate","score_count":3,"state_name":"Alaska"}]},{"name":"Relatively High","children":[{"name":"1","risk_score":"Relatively High","score_count":1,"state_name":"Alaska"}]}]},{"name":"Arizona","children":[{"name":"Very Low","children":[{"name":"1","risk_score":"Very Low","score_count":1,"state_name":"Arizona"}]},{"name":"Relatively Low","children":[{"name":"2","risk_score":"Relatively Low","score_count":2,"state_name":"Arizona"}]},{"name":"Relatively Moderate","children":[{"name":"9","risk_score":"Relatively Moderate","score_count":9,"state_name":"Arizona"}]},{"name":"Relatively High","children":[{"name":"2","risk_score":"Relatively High","score_count":2,"state_name":"Arizona"}]},{"name":"Very High","children":[{"name":"1","risk_score":"Very High","score_count":1,"state_name":"Arizona"}]}]},{"name":"Arkansas","children":[{"name":"Very Low","children":[{"name":"22","risk_score":"Very Low","score_count":22,"state_name":"Arkansas"}]},{"name":"Relatively Low","children":[{"name":"42","risk_score":"Relatively Low","score_count":42,"state_name":"Arkansas"}]},{"name":"Relatively Moderate","children":[{"name":"10","risk_score":"Relatively Moderate","score_count":10,"state_name":"Arkansas"}]},{"name":"Relatively High","children":[{"name":"1","risk_score":"Relatively High","score_count":1,"state_name":"Arkansas"}]}]},{"name":"California","children":[{"name":"Very Low","children":[{"name":"3","risk_score":"Very Low","score_count":3,"state_name":"California"}]},{"name":"Relatively Low","children":[{"name":"7","risk_score":"Relatively Low","score_count":7,"state_name":"California"}]},{"name":"Relatively Moderate","children":[{"name":"17","risk_score":"Relatively Moderate","score_count":17,"state_name":"California"}]},{"name":"Relatively High","children":[{"name":"22","risk_score":"Relatively High","score_count":22,"state_name":"California"}]},{"name":"Very High","children":[{"name":"9","risk_score":"Very High","score_count":9,"state_name":"California"}]}]},{"name":"Colorado","children":[{"name":"Very Low","children":[{"name":"35","risk_score":"Very Low","score_count":35,"state_name":"Colorado"}]},{"name":"Relatively Low","children":[{"name":"19","risk_score":"Relatively Low","score_count":19,"state_name":"Colorado"}]},{"name":"Relatively Moderate","children":[{"name":"8","risk_score":"Relatively Moderate","score_count":8,"state_name":"Colorado"}]},{"name":"Relatively High","children":[{"name":"2","risk_score":"Relatively High","score_count":2,"state_name":"Colorado"}]}]},{"name":"Connecticut","children":[{"name":"Relatively Low","children":[{"name":"2","risk_score":"Relatively Low","score_count":2,"state_name":"Connecticut"}]},{"name":"Relatively Moderate","children":[{"name":"4","risk_score":"Relatively Moderate","score_count":4,"state_name":"Connecticut"}]},{"name":"Relatively High","children":[{"name":"3","risk_score":"Relatively High","score_count":3,"state_name":"Connecticut"}]}]},{"name":"Delaware","children":[{"name":"Relatively Moderate","children":[{"name":"2","risk_score":"Relatively Moderate","score_count":2,"state_name":"Delaware"}]},{"name":"Relatively High","children":[{"name":"1","risk_score":"Relatively High","score_count":1,"state_name":"Delaware"}]}]},{"name":"District of Columbia","children":[{"name":"Relatively High","children":[{"name":"1","risk_score":"Relatively High","score_count":1,"state_name":"District of Columbia"}]}]},{"name":"Florida","children":[{"name":"Very Low","children":[{"name":"8","risk_score":"Very Low","score_count":8,"state_name":"Florida"}]},{"name":"Relatively Low","children":[{"name":"20","risk_score":"Relatively Low","score_count":20,"state_name":"Florida"}]},{"name":"Relatively Moderate","children":[{"name":"18","risk_score":"Relatively Moderate","score_count":18,"state_name":"Florida"}]},{"name":"Relatively High","children":[{"name":"20","risk_score":"Relatively High","score_count":20,"state_name":"Florida"}]},{"name":"Very High","children":[{"name":"1","risk_score":"Very High","score_count":1,"state_name":"Florida"}]}]},{"name":"Georgia","children":[{"name":"Very Low","children":[{"name":"90","risk_score":"Very Low","score_count":90,"state_name":"Georgia"}]},{"name":"Relatively Low","children":[{"name":"53","risk_score":"Relatively Low","score_count":53,"state_name":"Georgia"}]},{"name":"Relatively Moderate","children":[{"name":"12","risk_score":"Relatively Moderate","score_count":12,"state_name":"Georgia"}]},{"name":"Relatively High","children":[{"name":"4","risk_score":"Relatively High","score_count":4,"state_name":"Georgia"}]}]},{"name":"Hawaii","children":[{"name":"Very Low","children":[{"name":"1","risk_score":"Very Low","score_count":1,"state_name":"Hawaii"}]},{"name":"Relatively Moderate","children":[{"name":"2","risk_score":"Relatively Moderate","score_count":2,"state_name":"Hawaii"}]},{"name":"Relatively High","children":[{"name":"2","risk_score":"Relatively High","score_count":2,"state_name":"Hawaii"}]}]},{"name":"Idaho","children":[{"name":"Very Low","children":[{"name":"25","risk_score":"Very Low","score_count":25,"state_name":"Idaho"}]},{"name":"Relatively Low","children":[{"name":"17","risk_score":"Relatively Low","score_count":17,"state_name":"Idaho"}]},{"name":"Relatively Moderate","children":[{"name":"2","risk_score":"Relatively Moderate","score_count":2,"state_name":"Idaho"}]}]},{"name":"Illinois","children":[{"name":"Very Low","children":[{"name":"37","risk_score":"Very Low","score_count":37,"state_name":"Illinois"}]},{"name":"Relatively Low","children":[{"name":"45","risk_score":"Relatively Low","score_count":45,"state_name":"Illinois"}]},{"name":"Relatively Moderate","children":[{"name":"14","risk_score":"Relatively Moderate","score_count":14,"state_name":"Illinois"}]},{"name":"Relatively High","children":[{"name":"5","risk_score":"Relatively High","score_count":5,"state_name":"Illinois"}]},{"name":"Very High","children":[{"name":"1","risk_score":"Very High","score_count":1,"state_name":"Illinois"}]}]},{"name":"Indiana","children":[{"name":"Very Low","children":[{"name":"46","risk_score":"Very Low","score_count":46,"state_name":"Indiana"}]},{"name":"Relatively Low","children":[{"name":"35","risk_score":"Relatively Low","score_count":35,"state_name":"Indiana"}]},{"name":"Relatively Moderate","children":[{"name":"9","risk_score":"Relatively Moderate","score_count":9,"state_name":"Indiana"}]},{"name":"Relatively High","children":[{"name":"2","risk_score":"Relatively High","score_count":2,"state_name":"Indiana"}]}]},{"name":"Iowa","children":[{"name":"Very Low","children":[{"name":"64","risk_score":"Very Low","score_count":64,"state_name":"Iowa"}]},{"name":"Relatively Low","children":[{"name":"30","risk_score":"Relatively Low","score_count":30,"state_name":"Iowa"}]},{"name":"Relatively Moderate","children":[{"name":"5","risk_score":"Relatively Moderate","score_count":5,"state_name":"Iowa"}]}]},{"name":"Kansas","children":[{"name":"Very Low","children":[{"name":"80","risk_score":"Very Low","score_count":80,"state_name":"Kansas"}]},{"name":"Relatively Low","children":[{"name":"21","risk_score":"Relatively Low","score_count":21,"state_name":"Kansas"}]},{"name":"Relatively Moderate","children":[{"name":"2","risk_score":"Relatively Moderate","score_count":2,"state_name":"Kansas"}]},{"name":"Relatively High","children":[{"name":"2","risk_score":"Relatively High","score_count":2,"state_name":"Kansas"}]}]},{"name":"Kentucky","children":[{"name":"Very Low","children":[{"name":"70","risk_score":"Very Low","score_count":70,"state_name":"Kentucky"}]},{"name":"Relatively Low","children":[{"name":"42","risk_score":"Relatively Low","score_count":42,"state_name":"Kentucky"}]},{"name":"Relatively Moderate","children":[{"name":"7","risk_score":"Relatively Moderate","score_count":7,"state_name":"Kentucky"}]},{"name":"Relatively High","children":[{"name":"1","risk_score":"Relatively High","score_count":1,"state_name":"Kentucky"}]}]},{"name":"Louisiana","children":[{"name":"Very Low","children":[{"name":"21","risk_score":"Very Low","score_count":21,"state_name":"Louisiana"}]},{"name":"Relatively Low","children":[{"name":"19","risk_score":"Relatively Low","score_count":19,"state_name":"Louisiana"}]},{"name":"Relatively Moderate","children":[{"name":"17","risk_score":"Relatively Moderate","score_count":17,"state_name":"Louisiana"}]},{"name":"Relatively High","children":[{"name":"7","risk_score":"Relatively High","score_count":7,"state_name":"Louisiana"}]}]},{"name":"Maine","children":[{"name":"Very Low","children":[{"name":"4","risk_score":"Very Low","score_count":4,"state_name":"Maine"}]},{"name":"Relatively Low","children":[{"name":"11","risk_score":"Relatively Low","score_count":11,"state_name":"Maine"}]},{"name":"Relatively Moderate","children":[{"name":"1","risk_score":"Relatively Moderate","score_count":1,"state_name":"Maine"}]}]},{"name":"Maryland","children":[{"name":"Very Low","children":[{"name":"6","risk_score":"Very Low","score_count":6,"state_name":"Maryland"}]},{"name":"Relatively Low","children":[{"name":"13","risk_score":"Relatively Low","score_count":13,"state_name":"Maryland"}]},{"name":"Relatively Moderate","children":[{"name":"4","risk_score":"Relatively Moderate","score_count":4,"state_name":"Maryland"}]},{"name":"Relatively High","children":[{"name":"1","risk_score":"Relatively High","score_count":1,"state_name":"Maryland"}]}]},{"name":"Massachusetts","children":[{"name":"Very Low","children":[{"name":"2","risk_score":"Very Low","score_count":2,"state_name":"Massachusetts"}]},{"name":"Relatively Low","children":[{"name":"2","risk_score":"Relatively Low","score_count":2,"state_name":"Massachusetts"}]},{"name":"Relatively Moderate","children":[{"name":"8","risk_score":"Relatively Moderate","score_count":8,"state_name":"Massachusetts"}]},{"name":"Relatively High","children":[{"name":"2","risk_score":"Relatively High","score_count":2,"state_name":"Massachusetts"}]}]},{"name":"Michigan","children":[{"name":"Very Low","children":[{"name":"33","risk_score":"Very Low","score_count":33,"state_name":"Michigan"}]},{"name":"Relatively Low","children":[{"name":"37","risk_score":"Relatively Low","score_count":37,"state_name":"Michigan"}]},{"name":"Relatively Moderate","children":[{"name":"10","risk_score":"Relatively Moderate","score_count":10,"state_name":"Michigan"}]},{"name":"Relatively High","children":[{"name":"3","risk_score":"Relatively High","score_count":3,"state_name":"Michigan"}]}]},{"name":"Minnesota","children":[{"name":"Very Low","children":[{"name":"43","risk_score":"Very Low","score_count":43,"state_name":"Minnesota"}]},{"name":"Relatively Low","children":[{"name":"36","risk_score":"Relatively Low","score_count":36,"state_name":"Minnesota"}]},{"name":"Relatively Moderate","children":[{"name":"6","risk_score":"Relatively Moderate","score_count":6,"state_name":"Minnesota"}]},{"name":"Relatively High","children":[{"name":"2","risk_score":"Relatively High","score_count":2,"state_name":"Minnesota"}]}]},{"name":"Mississippi","children":[{"name":"Very Low","children":[{"name":"31","risk_score":"Very Low","score_count":31,"state_name":"Mississippi"}]},{"name":"Relatively Low","children":[{"name":"39","risk_score":"Relatively Low","score_count":39,"state_name":"Mississippi"}]},{"name":"Relatively Moderate","children":[{"name":"11","risk_score":"Relatively Moderate","score_count":11,"state_name":"Mississippi"}]},{"name":"Relatively High","children":[{"name":"1","risk_score":"Relatively High","score_count":1,"state_name":"Mississippi"}]}]},{"name":"Missouri","children":[{"name":"Very Low","children":[{"name":"45","risk_score":"Very Low","score_count":45,"state_name":"Missouri"}]},{"name":"Relatively Low","children":[{"name":"56","risk_score":"Relatively Low","score_count":56,"state_name":"Missouri"}]},{"name":"Relatively Moderate","children":[{"name":"11","risk_score":"Relatively Moderate","score_count":11,"state_name":"Missouri"}]},{"name":"Relatively High","children":[{"name":"3","risk_score":"Relatively High","score_count":3,"state_name":"Missouri"}]}]},{"name":"Montana","children":[{"name":"Very Low","children":[{"name":"34","risk_score":"Very Low","score_count":34,"state_name":"Montana"}]},{"name":"Relatively Low","children":[{"name":"18","risk_score":"Relatively Low","score_count":18,"state_name":"Montana"}]},{"name":"Relatively Moderate","children":[{"name":"4","risk_score":"Relatively Moderate","score_count":4,"state_name":"Montana"}]}]},{"name":"Nebraska","children":[{"name":"Very Low","children":[{"name":"74","risk_score":"Very Low","score_count":74,"state_name":"Nebraska"}]},{"name":"Relatively Low","children":[{"name":"16","risk_score":"Relatively Low","score_count":16,"state_name":"Nebraska"}]},{"name":"Relatively Moderate","children":[{"name":"2","risk_score":"Relatively Moderate","score_count":2,"state_name":"Nebraska"}]},{"name":"Relatively High","children":[{"name":"1","risk_score":"Relatively High","score_count":1,"state_name":"Nebraska"}]}]},{"name":"Nevada","children":[{"name":"Very Low","children":[{"name":"9","risk_score":"Very Low","score_count":9,"state_name":"Nevada"}]},{"name":"Relatively Low","children":[{"name":"4","risk_score":"Relatively Low","score_count":4,"state_name":"Nevada"}]},{"name":"Relatively Moderate","children":[{"name":"2","risk_score":"Relatively Moderate","score_count":2,"state_name":"Nevada"}]},{"name":"Relatively High","children":[{"name":"1","risk_score":"Relatively High","score_count":1,"state_name":"Nevada"}]},{"name":"Very High","children":[{"name":"1","risk_score":"Very High","score_count":1,"state_name":"Nevada"}]}]},{"name":"New Hampshire","children":[{"name":"Very Low","children":[{"name":"1","risk_score":"Very Low","score_count":1,"state_name":"New Hampshire"}]},{"name":"Relatively Low","children":[{"name":"6","risk_score":"Relatively Low","score_count":6,"state_name":"New Hampshire"}]},{"name":"Relatively Moderate","children":[{"name":"3","risk_score":"Relatively Moderate","score_count":3,"state_name":"New Hampshire"}]}]},{"name":"New Jersey","children":[{"name":"Relatively Low","children":[{"name":"4","risk_score":"Relatively Low","score_count":4,"state_name":"New Jersey"}]},{"name":"Relatively Moderate","children":[{"name":"8","risk_score":"Relatively Moderate","score_count":8,"state_name":"New Jersey"}]},{"name":"Relatively High","children":[{"name":"9","risk_score":"Relatively High","score_count":9,"state_name":"New Jersey"}]}]},{"name":"New Mexico","children":[{"name":"Very Low","children":[{"name":"9","risk_score":"Very Low","score_count":9,"state_name":"New Mexico"}]},{"name":"Relatively Low","children":[{"name":"14","risk_score":"Relatively Low","score_count":14,"state_name":"New Mexico"}]},{"name":"Relatively Moderate","children":[{"name":"8","risk_score":"Relatively Moderate","score_count":8,"state_name":"New Mexico"}]},{"name":"Relatively High","children":[{"name":"2","risk_score":"Relatively High","score_count":2,"state_name":"New Mexico"}]}]},{"name":"New York","children":[{"name":"Very Low","children":[{"name":"8","risk_score":"Very Low","score_count":8,"state_name":"New York"}]},{"name":"Relatively Low","children":[{"name":"31","risk_score":"Relatively Low","score_count":31,"state_name":"New York"}]},{"name":"Relatively Moderate","children":[{"name":"15","risk_score":"Relatively Moderate","score_count":15,"state_name":"New York"}]},{"name":"Relatively High","children":[{"name":"8","risk_score":"Relatively High","score_count":8,"state_name":"New York"}]}]},{"name":"North Carolina","children":[{"name":"Very Low","children":[{"name":"17","risk_score":"Very Low","score_count":17,"state_name":"North Carolina"}]},{"name":"Relatively Low","children":[{"name":"52","risk_score":"Relatively Low","score_count":52,"state_name":"North Carolina"}]},{"name":"Relatively Moderate","children":[{"name":"26","risk_score":"Relatively Moderate","score_count":26,"state_name":"North Carolina"}]},{"name":"Relatively High","children":[{"name":"5","risk_score":"Relatively High","score_count":5,"state_name":"North Carolina"}]}]},{"name":"North Dakota","children":[{"name":"Very Low","children":[{"name":"41","risk_score":"Very Low","score_count":41,"state_name":"North Dakota"}]},{"name":"Relatively Low","children":[{"name":"10","risk_score":"Relatively Low","score_count":10,"state_name":"North Dakota"}]},{"name":"Relatively Moderate","children":[{"name":"2","risk_score":"Relatively Moderate","score_count":2,"state_name":"North Dakota"}]}]},{"name":"Ohio","children":[{"name":"Very Low","children":[{"name":"26","risk_score":"Very Low","score_count":26,"state_name":"Ohio"}]},{"name":"Relatively Low","children":[{"name":"51","risk_score":"Relatively Low","score_count":51,"state_name":"Ohio"}]},{"name":"Relatively Moderate","children":[{"name":"8","risk_score":"Relatively Moderate","score_count":8,"state_name":"Ohio"}]},{"name":"Relatively High","children":[{"name":"3","risk_score":"Relatively High","score_count":3,"state_name":"Ohio"}]}]},{"name":"Oklahoma","children":[{"name":"Very Low","children":[{"name":"28","risk_score":"Very Low","score_count":28,"state_name":"Oklahoma"}]},{"name":"Relatively Low","children":[{"name":"36","risk_score":"Relatively Low","score_count":36,"state_name":"Oklahoma"}]},{"name":"Relatively Moderate","children":[{"name":"11","risk_score":"Relatively Moderate","score_count":11,"state_name":"Oklahoma"}]},{"name":"Relatively High","children":[{"name":"2","risk_score":"Relatively High","score_count":2,"state_name":"Oklahoma"}]}]},{"name":"Oregon","children":[{"name":"Very Low","children":[{"name":"12","risk_score":"Very Low","score_count":12,"state_name":"Oregon"}]},{"name":"Relatively Low","children":[{"name":"6","risk_score":"Relatively Low","score_count":6,"state_name":"Oregon"}]},{"name":"Relatively Moderate","children":[{"name":"12","risk_score":"Relatively Moderate","score_count":12,"state_name":"Oregon"}]},{"name":"Relatively High","children":[{"name":"6","risk_score":"Relatively High","score_count":6,"state_name":"Oregon"}]}]},{"name":"Pennsylvania","children":[{"name":"Very Low","children":[{"name":"8","risk_score":"Very Low","score_count":8,"state_name":"Pennsylvania"}]},{"name":"Relatively Low","children":[{"name":"38","risk_score":"Relatively Low","score_count":38,"state_name":"Pennsylvania"}]},{"name":"Relatively Moderate","children":[{"name":"16","risk_score":"Relatively Moderate","score_count":16,"state_name":"Pennsylvania"}]},{"name":"Relatively High","children":[{"name":"4","risk_score":"Relatively High","score_count":4,"state_name":"Pennsylvania"}]},{"name":"Very High","children":[{"name":"1","risk_score":"Very High","score_count":1,"state_name":"Pennsylvania"}]}]},{"name":"Rhode Island","children":[{"name":"Very Low","children":[{"name":"2","risk_score":"Very Low","score_count":2,"state_name":"Rhode Island"}]},{"name":"Relatively Low","children":[{"name":"2","risk_score":"Relatively Low","score_count":2,"state_name":"Rhode Island"}]},{"name":"Relatively Moderate","children":[{"name":"1","risk_score":"Relatively Moderate","score_count":1,"state_name":"Rhode Island"}]}]},{"name":"South Carolina","children":[{"name":"Very Low","children":[{"name":"7","risk_score":"Very Low","score_count":7,"state_name":"South Carolina"}]},{"name":"Relatively Low","children":[{"name":"19","risk_score":"Relatively Low","score_count":19,"state_name":"South Carolina"}]},{"name":"Relatively Moderate","children":[{"name":"16","risk_score":"Relatively Moderate","score_count":16,"state_name":"South Carolina"}]},{"name":"Relatively High","children":[{"name":"4","risk_score":"Relatively High","score_count":4,"state_name":"South Carolina"}]}]},{"name":"South Dakota","children":[{"name":"Very Low","children":[{"name":"50","risk_score":"Very Low","score_count":50,"state_name":"South Dakota"}]},{"name":"Relatively Low","children":[{"name":"15","risk_score":"Relatively Low","score_count":15,"state_name":"South Dakota"}]},{"name":"Relatively Moderate","children":[{"name":"1","risk_score":"Relatively Moderate","score_count":1,"state_name":"South Dakota"}]}]},{"name":"Tennessee","children":[{"name":"Very Low","children":[{"name":"31","risk_score":"Very Low","score_count":31,"state_name":"Tennessee"}]},{"name":"Relatively Low","children":[{"name":"50","risk_score":"Relatively Low","score_count":50,"state_name":"Tennessee"}]},{"name":"Relatively Moderate","children":[{"name":"12","risk_score":"Relatively Moderate","score_count":12,"state_name":"Tennessee"}]},{"name":"Relatively High","children":[{"name":"2","risk_score":"Relatively High","score_count":2,"state_name":"Tennessee"}]}]},{"name":"Texas","children":[{"name":"Very Low","children":[{"name":"113","risk_score":"Very Low","score_count":113,"state_name":"Texas"}]},{"name":"Relatively Low","children":[{"name":"92","risk_score":"Relatively Low","score_count":92,"state_name":"Texas"}]},{"name":"Relatively Moderate","children":[{"name":"33","risk_score":"Relatively Moderate","score_count":33,"state_name":"Texas"}]},{"name":"Relatively High","children":[{"name":"14","risk_score":"Relatively High","score_count":14,"state_name":"Texas"}]},{"name":"Very High","children":[{"name":"2","risk_score":"Very High","score_count":2,"state_name":"Texas"}]}]},{"name":"Utah","children":[{"name":"Very Low","children":[{"name":"19","risk_score":"Very Low","score_count":19,"state_name":"Utah"}]},{"name":"Relatively Low","children":[{"name":"5","risk_score":"Relatively Low","score_count":5,"state_name":"Utah"}]},{"name":"Relatively Moderate","children":[{"name":"3","risk_score":"Relatively Moderate","score_count":3,"state_name":"Utah"}]},{"name":"Relatively High","children":[{"name":"2","risk_score":"Relatively High","score_count":2,"state_name":"Utah"}]}]},{"name":"Vermont","children":[{"name":"Very Low","children":[{"name":"8","risk_score":"Very Low","score_count":8,"state_name":"Vermont"}]},{"name":"Relatively Low","children":[{"name":"6","risk_score":"Relatively Low","score_count":6,"state_name":"Vermont"}]}]},{"name":"Virginia","children":[{"name":"Very Low","children":[{"name":"85","risk_score":"Very Low","score_count":85,"state_name":"Virginia"}]},{"name":"Relatively Low","children":[{"name":"42","risk_score":"Relatively Low","score_count":42,"state_name":"Virginia"}]},{"name":"Relatively Moderate","children":[{"name":"5","risk_score":"Relatively Moderate","score_count":5,"state_name":"Virginia"}]},{"name":"Relatively High","children":[{"name":"1","risk_score":"Relatively High","score_count":1,"state_name":"Virginia"}]}]},{"name":"Washington","children":[{"name":"Very Low","children":[{"name":"8","risk_score":"Very Low","score_count":8,"state_name":"Washington"}]},{"name":"Relatively Low","children":[{"name":"11","risk_score":"Relatively Low","score_count":11,"state_name":"Washington"}]},{"name":"Relatively Moderate","children":[{"name":"15","risk_score":"Relatively Moderate","score_count":15,"state_name":"Washington"}]},{"name":"Relatively High","children":[{"name":"4","risk_score":"Relatively High","score_count":4,"state_name":"Washington"}]},{"name":"Very High","children":[{"name":"1","risk_score":"Very High","score_count":1,"state_name":"Washington"}]}]},{"name":"West Virginia","children":[{"name":"Very Low","children":[{"name":"23","risk_score":"Very Low","score_count":23,"state_name":"West Virginia"}]},{"name":"Relatively Low","children":[{"name":"30","risk_score":"Relatively Low","score_count":30,"state_name":"West Virginia"}]},{"name":"Relatively Moderate","children":[{"name":"1","risk_score":"Relatively Moderate","score_count":1,"state_name":"West Virginia"}]},{"name":"Relatively High","children":[{"name":"1","risk_score":"Relatively High","score_count":1,"state_name":"West Virginia"}]}]},{"name":"Wisconsin","children":[{"name":"Very Low","children":[{"name":"15","risk_score":"Very Low","score_count":15,"state_name":"Wisconsin"}]},{"name":"Relatively Low","children":[{"name":"47","risk_score":"Relatively Low","score_count":47,"state_name":"Wisconsin"}]},{"name":"Relatively Moderate","children":[{"name":"9","risk_score":"Relatively Moderate","score_count":9,"state_name":"Wisconsin"}]},{"name":"Relatively High","children":[{"name":"1","risk_score":"Relatively High","score_count":1,"state_name":"Wisconsin"}]}]},{"name":"Wyoming","children":[{"name":"Very Low","children":[{"name":"14","risk_score":"Very Low","score_count":14,"state_name":"Wyoming"}]},{"name":"Relatively Low","children":[{"name":"9","risk_score":"Relatively Low","score_count":9,"state_name":"Wyoming"}]}]}]},"options":{"size":"score_count","color_min":"hsl(56,80%,80%)","color_max":"hsl(341,30%,40%)"}},"evals":[],"jsHooks":[]}</script>
</div>
</div>
</section>
</section>
<section id="step-5-beautify-sunburst-plot" class="level3">
<h3 class="anchored" data-anchor-id="step-5-beautify-sunburst-plot">Step 5: Beautify sunburst plot</h3>
<p>The sunburst plot depicts distribution of risk scores per state in a clear and visually appealling way. With some adjustments, we can highlight California’s scores and compare to other states.</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="co"># filter data for this plot</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>nri_sunburst <span class="ot">&lt;-</span> nri <span class="sc">%&gt;%</span> </span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>  <span class="co"># rename risk scores</span></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">risk_score =</span> national_risk_index_rating_composite) <span class="sc">%&gt;%</span> </span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(risk_score <span class="sc">!=</span> <span class="st">"Insufficient Data"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>  <span class="co"># refactor for plotting</span></span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">risk_score =</span> <span class="fu">fct_relevel</span>(risk_score, <span class="st">"Very Low"</span>, <span class="st">"Relatively Low"</span>, <span class="st">"Relatively Moderate"</span>, <span class="st">"Relatively High"</span>, <span class="st">"Very High"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a>  <span class="co"># calculate total counts of each risk score</span></span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(state_name_abbreviation, risk_score) <span class="sc">%&gt;%</span> </span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">score_count =</span> <span class="fu">n</span>()) <span class="sc">%&gt;%</span> </span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb9-12"><a href="#cb9-12" aria-hidden="true" tabindex="-1"></a>  <span class="co"># calculate percentage totals to normalize for different amounts of counties</span></span>
<span id="cb9-13"><a href="#cb9-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(state_name_abbreviation) <span class="sc">%&gt;%</span> </span>
<span id="cb9-14"><a href="#cb9-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">total =</span> <span class="fu">sum</span>(score_count)) <span class="sc">%&gt;%</span> </span>
<span id="cb9-15"><a href="#cb9-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb9-16"><a href="#cb9-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">percent =</span> <span class="fu">round</span>(score_count <span class="sc">/</span> total, <span class="dv">2</span>))</span>
<span id="cb9-17"><a href="#cb9-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-18"><a href="#cb9-18" aria-hidden="true" tabindex="-1"></a><span class="co"># set order level of states</span></span>
<span id="cb9-19"><a href="#cb9-19" aria-hidden="true" tabindex="-1"></a>levels <span class="ot">&lt;-</span> nri_sunburst <span class="sc">%&gt;%</span> </span>
<span id="cb9-20"><a href="#cb9-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(risk_score <span class="sc">==</span> <span class="st">"Very Low"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb9-21"><a href="#cb9-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="sc">-</span>percent) <span class="sc">%&gt;%</span> </span>
<span id="cb9-22"><a href="#cb9-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">order =</span> <span class="fu">row_number</span>()) <span class="sc">%&gt;%</span> </span>
<span id="cb9-23"><a href="#cb9-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(state_name_abbreviation, order)</span>
<span id="cb9-24"><a href="#cb9-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-25"><a href="#cb9-25" aria-hidden="true" tabindex="-1"></a><span class="co"># join order with nri scores</span></span>
<span id="cb9-26"><a href="#cb9-26" aria-hidden="true" tabindex="-1"></a>nri_sunburst <span class="ot">&lt;-</span> nri_sunburst <span class="sc">%&gt;%</span> </span>
<span id="cb9-27"><a href="#cb9-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(levels, <span class="at">by =</span> <span class="st">"state_name_abbreviation"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb9-28"><a href="#cb9-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">replace</span>(<span class="fu">is.na</span>(.), <span class="dv">0</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb9-29"><a href="#cb9-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">state_name_abbreviation =</span> <span class="fu">fct_reorder</span>(<span class="at">.f =</span> state_name_abbreviation, <span class="at">.x =</span> order)) <span class="sc">%&gt;%</span> </span>
<span id="cb9-30"><a href="#cb9-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">california =</span> <span class="fu">ifelse</span>(state_name_abbreviation <span class="sc">==</span> <span class="st">"CA"</span>, <span class="st">"border"</span>, <span class="st">"NA"</span>))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="co"># plot!</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(nri_sunburst) <span class="sc">+</span></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="fu">aes</span>(<span class="at">x =</span> state_name_abbreviation, <span class="at">y =</span> percent, <span class="at">fill =</span> risk_score, <span class="at">color =</span> california), <span class="at">stat =</span> <span class="st">"identity"</span>) <span class="sc">+</span></span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>  <span class="co"># add inner circle</span></span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylim</span>(<span class="sc">-</span><span class="fl">0.5</span>, <span class="fl">1.01</span>) <span class="sc">+</span></span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>  <span class="co"># define california outline</span></span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"blue"</span>, <span class="st">"white"</span>)) <span class="sc">+</span></span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a>  <span class="co"># remove outline legend</span></span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">color =</span> <span class="st">"none"</span>) <span class="sc">+</span></span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a>  <span class="co"># use viridis color palette </span></span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_viridis</span>(<span class="at">discrete=</span><span class="cn">TRUE</span>, <span class="at">option =</span> <span class="st">"rocket"</span>, <span class="at">direction =</span> <span class="sc">-</span><span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">""</span>, <span class="co"># remove axes titles</span></span>
<span id="cb10-13"><a href="#cb10-13" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">""</span>,</span>
<span id="cb10-14"><a href="#cb10-14" aria-hidden="true" tabindex="-1"></a>       <span class="at">fill =</span> <span class="st">"Risk Score"</span>,</span>
<span id="cb10-15"><a href="#cb10-15" aria-hidden="true" tabindex="-1"></a>       <span class="at">title =</span> <span class="st">"FEMA National Risk Index scores by U.S. State"</span>,</span>
<span id="cb10-16"><a href="#cb10-16" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">"County total risk scores in California compared to contiguous U.S states"</span>,</span>
<span id="cb10-17"><a href="#cb10-17" aria-hidden="true" tabindex="-1"></a>       <span class="at">caption =</span> <span class="st">"Data: FEMA National Risk Index (2025 Release)"</span>) <span class="sc">+</span></span>
<span id="cb10-18"><a href="#cb10-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_polar</span>() <span class="sc">+</span> <span class="co"># flip axes to polar circle</span></span>
<span id="cb10-19"><a href="#cb10-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>() <span class="sc">+</span></span>
<span id="cb10-20"><a href="#cb10-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.y =</span> <span class="fu">element_blank</span>(), <span class="co"># remove all lines</span></span>
<span id="cb10-21"><a href="#cb10-21" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.ticks.y =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb10-22"><a href="#cb10-22" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.line.x =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb10-23"><a href="#cb10-23" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.line.y =</span> <span class="fu">element_blank</span>())</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="HW2_files/figure-html/unnamed-chunk-9-1.png" class="img-fluid figure-img" alt="Circular stacked bar plot of total county FEMA national risk index scores by state, with California highlighted, arranged by highest number of 'very low' risk to lowest. California has the lowest number of 'very low' risk counties compared to other states." width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="conclusions" class="level3">
<h3 class="anchored" data-anchor-id="conclusions">Conclusions</h3>
<ol type="1">
<li>What are your variables of interest and what kinds of data (e.g.&nbsp;numeric, categorical, ordered, etc.) are they (a bullet point list is fine)?</li>
</ol>
<p>I decided to compare the total counts of each risk index score by state. While this does not depict each county individually (and since there are &gt;3000 counties, this was not possible), and we likely lose detail about the scores by not using a numeric score value, it represents the total counties for each state and the cumulative spread of risk scores across counties. States is a categorical variable, risk scores is ordered categorical variables, and the total counts are numeric.</p>
<ol start="2" type="1">
<li>How did you decide which type of graphic form was best suited for answering the question? What alternative graphic forms could you have used instead? Why did you settle on this particular graphic form?</li>
</ol>
<p>I created a list of possible graphics that would be appropriate for my variables and their data types. After making basic preliminary plots of each, I chose a sunburst plot as I felt it represented the spread of risk scores among all states to compare to California. My other options included a heatmap, treemap, or circular packing plot.</p>
<ol start="3" type="1">
<li>Summarize your main finding in no more than two sentences.</li>
</ol>
<p>Based on this visualization, we can see that California ranks the lowest for percentage of counties with a “very low” national risk index score. California has about half of the counties above “Relatively Moderate, which visually looks lower than most states. These results could be influenced by taking the composite rating instead of a summary of the numeric score.</p>
<ol start="4" type="1">
<li>What modifications did you make to this visualization to make it more easily readable?</li>
</ol>
<p>I adjusted the organization of bars to be decreasing in “very low” counts in order to reduce the visual noise from the high number of bars. I also reversed the viridis color scheme so the lightest color was the “very low” bar to better show off the other scores. Removing all panel lines, axes, and backgrounds helped remove visual noise and create a cleaner look. Finally, adding a blue border around California was added to bring attention to those data.</p>
<ol start="5" type="1">
<li>Is there anything you wanted to implement, but didn’t know how? If so, please describe.</li>
</ol>
<p>I wanted to adjust the border around California to be thicker and only surround the outside, along with NOT having to add a white border to all other bars. Additionally, I would have preferred the legend to be horizontal on the bottom, but every time I adjusted the position I could not limit the size to be smaller than the visualization itself.</p>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
      const outerScaffold = trigger.parentElement.cloneNode(true);
      const codeEl = outerScaffold.querySelector('code');
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
</div> <!-- /content -->




</body></html>